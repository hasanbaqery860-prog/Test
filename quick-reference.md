# Quick Reference: Authentik + Open edX Integration

## Essential Information

### Files to Create/Modify
1. **Only ONE file needed:** `~/.local/share/tutor/plugins/authentik_oauth2.py`
2. **No core Open edX files are modified**

### Authentik Configuration
```
Provider Type: OAuth2/OpenID Provider
Client ID: openedx-oauth2-client
Client Secret: [Generated by Authentik]
Application Slug: openedx
Redirect URIs:
  - http://local.openedx.io:8000/auth/complete/oidc/
  - http://studio.local.openedx.io:8001/auth/complete/oidc/
Scopes: openid, email, profile
```

### Open edX Plugin Configuration
```python
# Key settings in authentik_oauth2.py
SOCIAL_AUTH_AUTHENTIK_OAUTH2_KEY = "openedx-oauth2-client"
SOCIAL_AUTH_AUTHENTIK_OAUTH2_SECRET = "YOUR_SECRET_HERE"
SOCIAL_AUTH_AUTHENTIK_OAUTH2_ENDPOINT = "http://localhost:9000/application/o/openedx/"
```

### Quick Setup Commands
```bash
# 1. Copy plugin file
cp authentik_oauth2.py ~/.local/share/tutor/plugins/

# 2. Enable plugin
tutor plugins enable authentik_oauth2

# 3. Save and rebuild
tutor config save
tutor images build openedx

# 4. Restart
tutor local stop
tutor local start -d
```

### Testing URLs
- Login page: http://local.openedx.io:8000/login
- OIDC Discovery: http://localhost:9000/application/o/openedx/.well-known/openid-configuration

### Troubleshooting Commands
```bash
# Check logs
tutor local logs -f lms --tail=100

# Verify plugin is enabled
tutor plugins list

# Test in Django shell
tutor local run lms ./manage.py lms shell
```

### Important: After ANY plugin changes
1. `tutor config save`
2. `tutor images build openedx`
3. `tutor local restart`