name: openedx-lms-urls
content: |
  # Redirect to MFE with auto-SSO hint
  from django.urls import re_path
  from django.http import HttpResponseRedirect
  from django.conf import settings
  
  def mfe_sso_redirect(request):
      """Redirect to MFE with SSO hint for auto-redirect"""
      mfe_url = getattr(settings, 'AUTHN_MICROFRONTEND_URL', 'http://91.107.146.137:1999/authn')
      next_url = request.GET.get('next', '/dashboard')
      # tpa_hint=oidc will trigger auto-redirect in MFE
      return HttpResponseRedirect(f"{mfe_url}/login?next={next_url}&tpa_hint=oidc")
  
  # Override login URLs to go to MFE with SSO hint
  auth_redirects = [
      re_path(r'^login/?$', mfe_sso_redirect),
      re_path(r'^register/?$', mfe_sso_redirect),
      re_path(r'^signin/?$', mfe_sso_redirect),
      re_path(r'^signup/?$', mfe_sso_redirect),
  ]
  
  urlpatterns = auth_redirects + urlpatterns