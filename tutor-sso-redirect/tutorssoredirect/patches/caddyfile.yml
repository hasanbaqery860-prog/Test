name: caddyfile
content: |
  # Redirect login/register URLs at the web server level
  {$default_site_port} {
      # Redirect any URL containing login/register/signin patterns
      @auth_urls {
          path_regexp auth_pattern (login|register|signin|signup|authn)
          not path /auth/login/oidc* /auth/complete/* /api/* /static/* /media/* /admin/*
      }
      
      redir @auth_urls {$OPENEDX_LMS_BASE_URL}{{ SSO_REDIRECT_URL }} permanent
  }